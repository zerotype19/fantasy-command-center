{
  "version": 3,
  "sources": ["../bundle-41kHW4/checked-fetch.js", "../bundle-41kHW4/strip-cf-connecting-ip-header.js", "../../../src/utils/db.ts", "../../../src/utils/fetchHelpers.ts", "../../../src/services/noaa.ts", "../../../src/services/espn.ts", "../../../src/handlers/league.ts", "../../../src/services/sleeper.ts", "../../../src/services/fantasyPros.ts", "../../../src/handlers/players.ts", "../../../src/handlers/alerts.ts", "../../../src/handlers/team.ts", "../../../src/index.ts", "../../../../../node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../../../node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-41kHW4/middleware-insertion-facade.js", "../../../../../node_modules/wrangler/templates/middleware/common.ts", "../bundle-41kHW4/middleware-loader.entry.ts"],
  "sourceRoot": "/Users/kevinmcgovern/fantasy-command-center/fantasy-command-center/apps/api/.wrangler/tmp/dev-PVwgct",
  "sourcesContent": ["const urls = new Set();\n\nfunction checkURL(request, init) {\n\tconst url =\n\t\trequest instanceof URL\n\t\t\t? request\n\t\t\t: new URL(\n\t\t\t\t\t(typeof request === \"string\"\n\t\t\t\t\t\t? new Request(request, init)\n\t\t\t\t\t\t: request\n\t\t\t\t\t).url\n\t\t\t\t);\n\tif (url.port && url.port !== \"443\" && url.protocol === \"https:\") {\n\t\tif (!urls.has(url.toString())) {\n\t\t\turls.add(url.toString());\n\t\t\tconsole.warn(\n\t\t\t\t`WARNING: known issue with \\`fetch()\\` requests to custom HTTPS ports in published Workers:\\n` +\n\t\t\t\t\t` - ${url.toString()} - the custom port will be ignored when the Worker is published using the \\`wrangler deploy\\` command.\\n`\n\t\t\t);\n\t\t}\n\t}\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\tconst [request, init] = argArray;\n\t\tcheckURL(request, init);\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n", "function stripCfConnectingIPHeader(input, init) {\n\tconst request = new Request(input, init);\n\trequest.headers.delete(\"CF-Connecting-IP\");\n\treturn request;\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\treturn Reflect.apply(target, thisArg, [\n\t\t\tstripCfConnectingIPHeader.apply(null, argArray),\n\t\t]);\n\t},\n});\n", "export class DatabaseService {\n  private db: any;\n\n  constructor(db: any) {\n    this.db = db;\n  }\n\n  // Player management\n  async getAllPlayers(): Promise<any[]> {\n    const result = await this.db.prepare(\n      'SELECT * FROM players ORDER BY name'\n    ).all();\n    return result.results || [];\n  }\n\n  async getPlayerByEspnId(espnId: string): Promise<any> {\n    const result = await this.db.prepare(\n      'SELECT * FROM players WHERE espn_id = ?'\n    ).bind(espnId).first();\n    return result;\n  }\n\n  async getPlayerBySleeperId(sleeperId: string): Promise<any> {\n    const result = await this.db.prepare(\n      'SELECT * FROM players WHERE sleeper_id = ?'\n    ).bind(sleeperId).first();\n    return result;\n  }\n\n  async getPlayersBySleeperIds(sleeperIds: string[]): Promise<any[]> {\n    if (sleeperIds.length === 0) return [];\n    \n    const placeholders = sleeperIds.map(() => '?').join(',');\n    const result = await this.db.prepare(\n      `SELECT * FROM players WHERE sleeper_id IN (${placeholders})`\n    ).bind(...sleeperIds).all();\n    return result.results || [];\n  }\n\n  async upsertSleeperPlayers(players: any[]): Promise<void> {\n    if (players.length === 0) return;\n\n    // Insert all available fields from Sleeper API\n    const stmt = this.db.prepare(`\n      INSERT OR REPLACE INTO players (\n        sleeper_id, espn_id, name, position, team, status, bye_week,\n        age, years_exp, college, weight, height, jersey_number, fantasy_positions,\n        fantasy_data_id, search_rank, injury_status, injury_start_date, injury_notes,\n        practice_participation, depth_chart_position, depth_chart_order, yahoo_id,\n        rotowire_id, rotoworld_id, sportradar_id, first_name, last_name, birth_date,\n        birth_city, birth_state, birth_country, high_school, hashtag, team_abbr,\n        team_changed_at, gsis_id, swish_id, stats_id, oddsjam_id, opta_id,\n        pandascore_id, sport, news_updated, practice_description, injury_body_part,\n        search_first_name, search_last_name, search_full_name, metadata, competitions\n      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    `);\n\n    const batch = players.map(player => \n      stmt.bind(\n        player.sleeper_id,\n        player.espn_id || null,\n        player.name,\n        player.position,\n        player.team,\n        player.status,\n        player.bye_week,\n        player.age || null,\n        player.years_exp || null,\n        player.college || null,\n        player.weight || null,\n        player.height || null,\n        player.jersey_number || null,\n        player.fantasy_positions ? JSON.stringify(player.fantasy_positions) : null,\n        player.fantasy_data_id || null,\n        player.search_rank || null,\n        player.injury_status || null,\n        player.injury_start_date || null,\n        player.injury_notes || null,\n        player.practice_participation || null,\n        player.depth_chart_position || null,\n        player.depth_chart_order || null,\n        player.yahoo_id || null,\n        player.rotowire_id || null,\n        player.rotoworld_id || null,\n        player.sportradar_id || null,\n        player.first_name || null,\n        player.last_name || null,\n        player.birth_date || null,\n        player.birth_city || null,\n        player.birth_state || null,\n        player.birth_country || null,\n        player.high_school || null,\n        player.hashtag || null,\n        player.team_abbr || null,\n        player.team_changed_at || null,\n        player.gsis_id || null,\n        player.swish_id || null,\n        player.stats_id || null,\n        player.oddsjam_id || null,\n        player.opta_id || null,\n        player.pandascore_id || null,\n        player.sport || null,\n        player.news_updated || null,\n        player.practice_description || null,\n        player.injury_body_part || null,\n        player.search_first_name || null,\n        player.search_last_name || null,\n        player.search_full_name || null,\n        player.metadata ? JSON.stringify(player.metadata) : null,\n        player.competitions ? JSON.stringify(player.competitions) : null\n      )\n    );\n\n    await this.db.batch(batch);\n  }\n\n  // Projection management\n  async getProjectionByPlayerId(playerId: number): Promise<any> {\n    const result = await this.db.prepare(\n      'SELECT * FROM projections WHERE player_id = ? ORDER BY week DESC LIMIT 1'\n    ).bind(playerId).first();\n    return result;\n  }\n\n  // Trending players management\n  async getTrendingPlayers(type: string, limit: number = 10): Promise<any[]> {\n    const result = await this.db.prepare(`\n      SELECT tp.*, p.name, p.position, p.team, p.status\n      FROM trending_players tp\n      LEFT JOIN players p ON tp.sleeper_id = p.sleeper_id\n      WHERE tp.type = ?\n      ORDER BY tp.count DESC, tp.created_at DESC\n      LIMIT ?\n    `).bind(type, limit).all();\n    return result.results || [];\n  }\n\n  async getTrendingPlayersByLookback(type: string, lookbackHours: number, limit: number = 10): Promise<any[]> {\n    const result = await this.db.prepare(`\n      SELECT tp.*, p.name, p.position, p.team, p.status\n      FROM trending_players tp\n      LEFT JOIN players p ON tp.sleeper_id = p.sleeper_id\n      WHERE tp.type = ? AND tp.lookback_hours = ? AND tp.created_at >= datetime('now', '-${lookbackHours} hours')\n      ORDER BY tp.count DESC, tp.created_at DESC\n      LIMIT ?\n    `).bind(type, lookbackHours, limit).all();\n    return result.results || [];\n  }\n}\n\n// Standalone trending players functions for the scheduled job\nexport async function upsertTrendingPlayers(\n  db: any, \n  trendingPlayers: any[], \n  type: string, \n  lookbackHours: number\n): Promise<void> {\n  if (trendingPlayers.length === 0) return;\n\n  const stmt = db.prepare(`\n    INSERT INTO trending_players (player_id, sleeper_id, type, count, lookback_hours)\n    VALUES (?, ?, ?, ?, ?)\n    ON CONFLICT(player_id, type, lookback_hours) DO UPDATE SET\n      count = excluded.count,\n      updated_at = CURRENT_TIMESTAMP\n  `);\n\n  const batch = trendingPlayers.map(player => \n    stmt.bind(\n      player.player_id,\n      player.player_id, // sleeper_id is the same as player_id for trending players\n      type,\n      player.count,\n      lookbackHours\n    )\n  );\n\n  await db.batch(batch);\n}\n\nexport async function getTrendingPlayers(db: any, type: string, limit: number = 10): Promise<any[]> {\n  const result = await db.prepare(`\n    SELECT tp.*, p.name, p.position, p.team, p.status\n    FROM trending_players tp\n    LEFT JOIN players p ON tp.sleeper_id = p.sleeper_id\n    WHERE tp.type = ?\n    ORDER BY tp.count DESC, tp.created_at DESC\n    LIMIT ?\n  `).bind(type, limit).all();\n  return result.results || [];\n}\n\nexport async function getTrendingPlayersByLookback(db: any, type: string, lookbackHours: number, limit: number = 10): Promise<any[]> {\n  const result = await db.prepare(`\n    SELECT tp.*, p.name, p.position, p.team, p.status\n    FROM trending_players tp\n    LEFT JOIN players p ON tp.sleeper_id = p.sleeper_id\n    WHERE tp.type = ? AND tp.lookback_hours = ? AND tp.created_at >= datetime('now', '-${lookbackHours} hours')\n    ORDER BY tp.count DESC, tp.created_at DESC\n    LIMIT ?\n  `).bind(type, lookbackHours, limit).all();\n  return result.results || [];\n}\n\n// FantasyPros data management\nexport async function upsertFantasyProsData(db: any, fantasyProsData: any[]): Promise<void> {\n  if (fantasyProsData.length === 0) return;\n\n  const stmt = db.prepare(`\n    INSERT OR REPLACE INTO fantasy_pros_data (\n      sleeper_id, source, week, season, ecr_rank, projected_points, \n      auction_value, sos_rank, tier, position_rank, value_over_replacement\n    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n  `);\n\n  const batch = fantasyProsData.map(item =>\n    stmt.bind(\n      item.sleeper_id,\n      item.source || 'FantasyPros',\n      item.week || null,\n      item.season || null,\n      item.ecr_rank || null,\n      item.projected_points || null,\n      item.auction_value || null,\n      item.sos_rank || null,\n      item.tier || null,\n      item.position_rank || null,\n      item.value_over_replacement || null\n    )\n  );\n\n  await db.batch(batch);\n}\n\nexport async function getPlayersWithFantasyData(db: any, week?: number, season?: number): Promise<any[]> {\n  let query = `\n    SELECT p.*, \n           MAX(fp.ecr_rank) as ecr_rank, \n           MAX(fp.projected_points) as projected_points, \n           MAX(fp.auction_value) as auction_value, \n           MAX(fp.sos_rank) as sos_rank, \n           MAX(fp.tier) as tier, \n           MAX(fp.position_rank) as position_rank, \n           MAX(fp.value_over_replacement) as value_over_replacement, \n           MAX(fp.source) as source\n    FROM players p\n    LEFT JOIN fantasy_pros_data fp ON p.sleeper_id = fp.sleeper_id\n  `;\n  \n  const params = [];\n  if (week || season) {\n    query += ' WHERE ';\n    const conditions = [];\n    if (week) {\n      conditions.push('fp.week = ?');\n      params.push(week);\n    }\n    if (season) {\n      conditions.push('fp.season = ?');\n      params.push(season);\n    }\n    query += conditions.join(' AND ');\n  }\n  \n  query += ' GROUP BY p.sleeper_id ORDER BY p.name';\n  \n  const result = await db.prepare(query).bind(...params).all();\n  return result.results || [];\n}\n", "export interface FetchOptions extends RequestInit {\n  retries?: number;\n  retryDelay?: number;\n  timeout?: number;\n}\n\nexport class FetchError extends Error {\n  constructor(\n    message: string,\n    public status: number,\n    public url: string,\n    public response?: Response\n  ) {\n    super(message);\n    this.name = 'FetchError';\n  }\n}\n\nexport async function fetchWithRetry(\n  url: string,\n  options: FetchOptions = {}\n): Promise<Response> {\n  const {\n    retries = 3,\n    retryDelay = 1000,\n    timeout = 10000,\n    ...fetchOptions\n  } = options;\n\n  let lastError: Error;\n\n  for (let attempt = 0; attempt <= retries; attempt++) {\n    try {\n      const controller = new AbortController();\n      const timeoutId = setTimeout(() => controller.abort(), timeout);\n\n      const response = await fetch(url, {\n        ...fetchOptions,\n        signal: controller.signal,\n      });\n\n      clearTimeout(timeoutId);\n\n      if (!response.ok) {\n        throw new FetchError(\n          `HTTP ${response.status}: ${response.statusText}`,\n          response.status,\n          url,\n          response\n        );\n      }\n\n      return response;\n    } catch (error) {\n      lastError = error as Error;\n      \n      if (attempt === retries) {\n        break;\n      }\n\n      // Don't retry on 4xx errors (client errors)\n      if (error instanceof FetchError && error.status >= 400 && error.status < 500) {\n        throw error;\n      }\n\n      // Wait before retrying\n      await new Promise(resolve => setTimeout(resolve, retryDelay * Math.pow(2, attempt)));\n    }\n  }\n\n  throw lastError!;\n}\n\nexport async function fetchJson<T = any>(\n  url: string,\n  options: FetchOptions = {}\n): Promise<T> {\n  const response = await fetchWithRetry(url, {\n    ...options,\n    headers: {\n      'Content-Type': 'application/json',\n      ...options.headers,\n    },\n  });\n\n  return response.json() as Promise<T>;\n}\n\nexport function createRateLimiter(maxRequests: number, timeWindow: number) {\n  const requests: number[] = [];\n\n  return function checkRateLimit(): boolean {\n    const now = Date.now();\n    const windowStart = now - timeWindow;\n\n    // Remove old requests outside the window\n    while (requests.length > 0 && requests[0] < windowStart) {\n      requests.shift();\n    }\n\n    if (requests.length >= maxRequests) {\n      return false; // Rate limit exceeded\n    }\n\n    requests.push(now);\n    return true; // Request allowed\n  };\n}\n\n// ESPN API rate limiter: 1 request per minute per league\nexport const espnRateLimiter = createRateLimiter(1, 60000);\n\n// FantasyPros rate limiter: 10 requests per minute\nexport const fantasyProsRateLimiter = createRateLimiter(10, 60000);\n\n// NOAA rate limiter: 5 requests per minute\nexport const noaaRateLimiter = createRateLimiter(5, 60000); ", "import { fetchJson, noaaRateLimiter } from '../utils/fetchHelpers';\n\nexport interface NOAAWeatherData {\n  latitude: number;\n  longitude: number;\n  date: string;\n  temperature?: number;\n  conditions?: string;\n  windSpeed?: number;\n  windDirection?: string;\n  humidity?: number;\n  precipitation?: number;\n}\n\nexport interface NOAAResponse {\n  properties?: {\n    periods?: Array<{\n      temperature: number;\n      shortForecast: string;\n      windSpeed: string;\n      windDirection: string;\n      relativeHumidity: {\n        value: number;\n      };\n      probabilityOfPrecipitation: {\n        value: number;\n      };\n    }>;\n  };\n  error?: string;\n}\n\nexport class NOAAService {\n  private baseUrl: string;\n\n  constructor(baseUrl: string) {\n    this.baseUrl = baseUrl;\n  }\n\n  async getGameWeather(\n    lat: number,\n    lon: number,\n    date: string\n  ): Promise<NOAAWeatherData> {\n    if (!noaaRateLimiter()) {\n      throw new Error('NOAA API rate limit exceeded. Please try again later.');\n    }\n\n    try {\n      // First, get the grid data for the coordinates\n      const gridResponse = await fetchJson<any>(`${this.baseUrl}/points/${lat},${lon}`);\n      \n      if (!gridResponse.properties?.gridId || !gridResponse.properties?.gridX || !gridResponse.properties?.gridY) {\n        throw new Error('Invalid grid data received from NOAA');\n      }\n\n      const { gridId, gridX, gridY } = gridResponse.properties;\n      \n      // Then get the forecast for that grid\n      const forecastUrl = `${this.baseUrl}/grids/${gridId}/${gridX},${gridY}/forecast`;\n      const forecastResponse = await fetchJson<NOAAResponse>(forecastUrl);\n\n      if (forecastResponse.error) {\n        throw new Error(`NOAA API error: ${forecastResponse.error}`);\n      }\n\n      // Parse the forecast data for the specific date\n      const weatherData = this.parseForecastForDate(forecastResponse, date);\n\n      return {\n        latitude: lat,\n        longitude: lon,\n        date,\n        ...weatherData\n      };\n\n    } catch (error) {\n      console.error('NOAA API error:', error);\n      throw new Error(`Failed to fetch weather data: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  private parseForecastForDate(response: NOAAResponse, targetDate: string): Partial<NOAAWeatherData> {\n    if (!response.properties?.periods || !Array.isArray(response.properties.periods)) {\n      return {};\n    }\n\n    // Find the forecast period that matches our target date\n    const targetPeriod = response.properties.periods.find(period => {\n      // This is a simplified date matching - we'll need to refine based on actual NOAA response format\n      return period.shortForecast && period.shortForecast.toLowerCase().includes(targetDate.toLowerCase());\n    });\n\n    if (!targetPeriod) {\n      return {};\n    }\n\n    return {\n      temperature: targetPeriod.temperature,\n      conditions: targetPeriod.shortForecast,\n      windSpeed: this.parseWindSpeed(targetPeriod.windSpeed),\n      windDirection: targetPeriod.windDirection,\n      humidity: targetPeriod.relativeHumidity?.value,\n      precipitation: targetPeriod.probabilityOfPrecipitation?.value\n    };\n  }\n\n  private parseWindSpeed(windSpeedStr: string): number | undefined {\n    // Parse wind speed string like \"10 mph\" to number\n    const match = windSpeedStr.match(/(\\d+)/);\n    return match ? parseInt(match[1], 10) : undefined;\n  }\n\n  async getWeatherForStadium(stadiumName: string, date: string): Promise<NOAAWeatherData | null> {\n    // Stadium coordinates mapping - we can expand this as needed\n    const stadiumCoords: { [key: string]: { lat: number; lon: number } } = {\n      'Lambeau Field': { lat: 44.5013, lon: -88.0622 },\n      'Soldier Field': { lat: 41.8623, lon: -87.6166 },\n      'Ford Field': { lat: 42.3400, lon: -83.0456 },\n      'MetLife Stadium': { lat: 40.8135, lon: -74.0741 },\n      // Add more stadiums as needed\n    };\n\n    const coords = stadiumCoords[stadiumName];\n    if (!coords) {\n      console.warn(`No coordinates found for stadium: ${stadiumName}`);\n      return null;\n    }\n\n    return this.getGameWeather(coords.lat, coords.lon, date);\n  }\n\n  async getWeatherForTeam(teamAbbreviation: string, date: string): Promise<NOAAWeatherData | null> {\n    // Team to stadium mapping - we can expand this as needed\n    const teamStadiums: { [key: string]: string } = {\n      'GB': 'Lambeau Field',\n      'CHI': 'Soldier Field',\n      'DET': 'Ford Field',\n      'NYG': 'MetLife Stadium',\n      'NYJ': 'MetLife Stadium',\n      // Add more teams as needed\n    };\n\n    const stadiumName = teamStadiums[teamAbbreviation];\n    if (!stadiumName) {\n      console.warn(`No stadium found for team: ${teamAbbreviation}`);\n      return null;\n    }\n\n    return this.getWeatherForStadium(stadiumName, date);\n  }\n} ", "import { fetchWithRetry } from '../utils/fetchHelpers';\n\n// ESPN position ID mapping\nexport const POSITIONS = {\n  1: \"QB\", \n  2: \"RB\", \n  3: \"WR\", \n  4: \"TE\", \n  5: \"K\", \n  16: \"DEF\"\n};\n\n// ESPN API base URL\nconst ESPN_BASE_URL = \"https://lm-api-reads.fantasy.espn.com/apis/v3/games/ffl\";\n\n// Pull full league data (settings, teams, rosters)\nexport async function fetchLeagueData(leagueId: string): Promise<any> {\n  const url = `${ESPN_BASE_URL}/seasons/2024/segments/0/leagues/${leagueId}?view=mSettings&view=mRoster&view=mTeam`;\n  \n  console.log(`Fetching ESPN league data for league ${leagueId}`);\n  \n  const response = await fetchWithRetry(url, {\n    method: 'GET',\n    headers: {\n      'Accept': 'application/json',\n    }\n  }, 1); // Retry once if failed\n\n  if (!response.ok) {\n    const errorText = await response.text();\n    console.error(`Failed to fetch ESPN league data for league ${leagueId}:`, {\n      status: response.status,\n      statusText: response.statusText,\n      errorText: errorText.substring(0, 500)\n    });\n    \n    if (response.status === 401) {\n      throw new Error(`League ${leagueId} is private or requires authentication. Please ensure you have access to this league.`);\n    } else if (response.status === 404) {\n      throw new Error(`League ${leagueId} not found. Please check the league ID.`);\n    } else {\n      throw new Error(`Failed to fetch ESPN league data: ${response.status} ${response.statusText}`);\n    }\n  }\n\n  const data = await response.json();\n  console.log(`Successfully fetched ESPN league data for league ${leagueId}`);\n  return data;\n}\n\n// Pull only one team's roster by teamId\nexport async function fetchTeamRoster(leagueId: string, teamId: number): Promise<any> {\n  const url = `${ESPN_BASE_URL}/seasons/2024/segments/0/leagues/${leagueId}?view=mRoster&rosterForTeamId=${teamId}`;\n  \n  console.log(`Fetching ESPN team roster for league ${leagueId}, team ${teamId}`);\n  \n  const response = await fetchWithRetry(url, {\n    method: 'GET',\n    headers: {\n      'Accept': 'application/json',\n    }\n  }, 1); // Retry once if failed\n\n  if (!response.ok) {\n    const errorText = await response.text();\n    console.error(`Failed to fetch ESPN team roster for league ${leagueId}, team ${teamId}:`, {\n      status: response.status,\n      statusText: response.statusText,\n      errorText: errorText.substring(0, 500)\n    });\n    \n    if (response.status === 401) {\n      throw new Error(`League ${leagueId} is private or requires authentication. Please ensure you have access to this league.`);\n    } else if (response.status === 404) {\n      throw new Error(`League ${leagueId} or team ${teamId} not found. Please check the IDs.`);\n    } else {\n      throw new Error(`Failed to fetch ESPN team roster: ${response.status} ${response.statusText}`);\n    }\n  }\n\n  const data = await response.json();\n  console.log(`Successfully fetched ESPN team roster for league ${leagueId}, team ${teamId}`);\n  return data;\n}\n\n// Extract players from ESPN roster data\nexport function extractPlayersFromRoster(rosterData: any): any[] {\n  const players: any[] = [];\n  \n  if (!rosterData || !rosterData.teams || !Array.isArray(rosterData.teams)) {\n    console.error('Missing expected ESPN roster structure:', rosterData);\n    throw new Error('Missing expected ESPN roster structure');\n  }\n\n  for (const team of rosterData.teams) {\n    if (!team.roster || !Array.isArray(team.roster.entries)) {\n      console.warn(`Team ${team.id} has no roster entries`);\n      continue;\n    }\n\n    for (const entry of team.roster.entries) {\n      if (!entry.playerPoolEntry || !entry.playerPoolEntry.player) {\n        console.warn('Invalid roster entry:', entry);\n        continue;\n      }\n\n      const player = entry.playerPoolEntry.player;\n      const positionId = player.defaultPositionId;\n      \n      players.push({\n        espn_id: player.id.toString(),\n        name: player.fullName || player.firstName + ' ' + player.lastName,\n        position: POSITIONS[positionId as keyof typeof POSITIONS] || 'UNK',\n        team: player.proTeamId ? getTeamAbbreviation(player.proTeamId) : 'FA',\n        status: player.injuryStatus || 'healthy',\n        bye_week: null, // TODO: Populate via schedule scraping or NFL calendar API\n        roster_status: entry.status || 'active'\n      });\n    }\n  }\n\n  console.log(`Extracted ${players.length} players from ESPN roster data`);\n  return players;\n}\n\n// Extract league settings from ESPN data\nexport function extractLeagueSettings(leagueData: any): any {\n  if (!leagueData || !leagueData.settings) {\n    console.error('Missing expected ESPN league settings structure:', leagueData);\n    throw new Error('Missing expected ESPN league settings structure');\n  }\n\n  const settings = leagueData.settings;\n  \n  return {\n    scoring_json: JSON.stringify(settings.scoringSettings || {}),\n    roster_json: JSON.stringify(settings.rosterSettings || {}),\n    keeper_rules_json: JSON.stringify(settings.keeperSettings || {}),\n    auction_budget: settings.auctionBudget || 0,\n    waiver_budget: settings.waiverBudget || 0\n  };\n}\n\n// Get team abbreviation from ESPN team ID\nfunction getTeamAbbreviation(teamId: number): string {\n  const TEAM_MAP: { [key: number]: string } = {\n    1: 'ATL', 2: 'BUF', 3: 'CHI', 4: 'CIN', 5: 'CLE', 6: 'DAL', 7: 'DEN', 8: 'DET',\n    9: 'GB', 10: 'TEN', 11: 'IND', 12: 'KC', 13: 'LV', 14: 'LAR', 15: 'MIA', 16: 'MIN',\n    17: 'NE', 18: 'NO', 19: 'NYG', 20: 'NYJ', 21: 'PHI', 22: 'ARI', 23: 'PIT', 24: 'LAC',\n    25: 'SF', 26: 'SEA', 27: 'TB', 28: 'WSH', 29: 'CAR', 30: 'JAX', 33: 'BAL', 34: 'HOU'\n  };\n  \n  return TEAM_MAP[teamId] || 'FA';\n} ", "import { DatabaseService } from '../utils/db';\nimport { fetchLeagueData, extractLeagueSettings } from '../services/espn';\n\nexport class LeagueHandler {\n  private db: DatabaseService;\n\n  constructor(db: DatabaseService) {\n    this.db = db;\n  }\n\n  async handlePost(request: Request): Promise<Response> {\n    try {\n      const body = await request.json() as any;\n      const { userId, leagueId, scoringJson, rosterJson, keeperRulesJson, auctionBudget, waiverBudget } = body;\n\n      if (!userId || !leagueId) {\n        return new Response(\n          JSON.stringify({ error: 'userId and leagueId are required' }),\n          { status: 400, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      await this.db.upsertLeagueSettings(\n        userId,\n        leagueId,\n        scoringJson || '{}',\n        rosterJson || '{}',\n        keeperRulesJson || '{}',\n        auctionBudget || 0,\n        waiverBudget || 0\n      );\n\n      return new Response(\n        JSON.stringify({ success: true, message: 'League settings saved' }),\n        { status: 200, headers: { 'Content-Type': 'application/json' } }\n      );\n\n    } catch (error) {\n      console.error('League POST error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Failed to save league settings' }),\n        { status: 500, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n  }\n\n  async handleGet(request: Request): Promise<Response> {\n    try {\n      const url = new URL(request.url);\n      const userId = url.searchParams.get('userId');\n      const leagueId = url.searchParams.get('leagueId');\n\n      if (!userId || !leagueId) {\n        return new Response(\n          JSON.stringify({ error: 'userId and leagueId are required' }),\n          { status: 400, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      const settings = await this.db.getLeagueSettings(userId, leagueId);\n\n      if (!settings) {\n        return new Response(\n          JSON.stringify({ error: 'League settings not found' }),\n          { status: 404, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      return new Response(\n        JSON.stringify(settings),\n        { status: 200, headers: { 'Content-Type': 'application/json' } }\n      );\n\n    } catch (error) {\n      console.error('League GET error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Failed to get league settings' }),\n        { status: 500, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n  }\n\n  async handleGetLeagueSettings(request: Request): Promise<Response> {\n    try {\n      const url = new URL(request.url);\n      const pathParts = url.pathname.split('/');\n      \n      // Extract leagueId from path: /league/:leagueId/settings\n      const leagueIdIndex = pathParts.indexOf('league') + 1;\n      const leagueId = pathParts[leagueIdIndex];\n\n      if (!leagueId) {\n        return new Response(\n          JSON.stringify({ error: 'leagueId is required in URL path' }),\n          { status: 400, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      console.log(`Fetching league settings for league ${leagueId}...`);\n\n      // Fetch league data from ESPN\n      const leagueData = await fetchLeagueData(leagueId);\n      \n      // Extract league settings\n      const settings = extractLeagueSettings(leagueData);\n\n      return new Response(\n        JSON.stringify({\n          success: true,\n          league_id: leagueId,\n          settings: settings\n        }),\n        { status: 200, headers: { 'Content-Type': 'application/json' } }\n      );\n\n    } catch (error) {\n      console.error('League settings GET error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Failed to fetch league settings' }),\n        { status: 500, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n  }\n} ", "// Sleeper API service for fetching player data\n// Documentation: https://docs.sleeper.com\n\nconst SLEEPER_BASE_URL = 'https://api.sleeper.app/v1';\n\nexport interface SleeperPlayer {\n  player_id: string;\n  full_name: string;\n  position: string;\n  team: string | null;\n  status: string | null;\n  active: boolean;\n  espn_id: number | null;\n  \n  // Player details\n  age: number | null;\n  years_exp: number | null;\n  college: string | null;\n  weight: string | null;\n  height: string | null;\n  number: number | null;\n  \n  // Fantasy data\n  fantasy_positions: string[] | null;\n  fantasy_data_id: number | null;\n  search_rank: number | null;\n  \n  // Injury/Status data\n  injury_status: string | null;\n  injury_start_date: string | null;\n  injury_notes: string | null;\n  practice_participation: string | null;\n  injury_body_part: string | null;\n  practice_description: string | null;\n  \n  // Team/Depth Chart\n  depth_chart_position: string | null;\n  depth_chart_order: number | null;\n  \n  // External IDs\n  yahoo_id: number | null;\n  rotowire_id: number | null;\n  rotoworld_id: number | null;\n  sportradar_id: string | null;\n  \n  // Additional Sleeper fields\n  first_name: string | null;\n  last_name: string | null;\n  birth_date: string | null;\n  birth_city: string | null;\n  birth_state: string | null;\n  birth_country: string | null;\n  high_school: string | null;\n  hashtag: string | null;\n  team_abbr: string | null;\n  team_changed_at: string | null;\n  gsis_id: string | null;\n  swish_id: number | null;\n  stats_id: number | null;\n  oddsjam_id: string | null;\n  opta_id: string | null;\n  pandascore_id: string | null;\n  sport: string | null;\n  news_updated: number | null;\n  search_first_name: string | null;\n  search_last_name: string | null;\n  search_full_name: string | null;\n  metadata: any | null;\n  competitions: any | null;\n}\n\nexport interface SleeperPlayersResponse {\n  [playerId: string]: SleeperPlayer;\n}\n\nexport interface TrendingPlayer {\n  player_id: string;\n  count: number;\n}\n\n// Fetch all NFL players from Sleeper API\nexport async function fetchAllPlayers(): Promise<SleeperPlayersResponse> {\n  const url = `${SLEEPER_BASE_URL}/players/nfl`;\n  \n  try {\n    const response = await fetch(url);\n    \n    if (response.status === 429) {\n      throw new Error('Sleeper API rate limited \u2014 please try again shortly.');\n    }\n    \n    if (!response.ok) {\n      throw new Error(`Failed to fetch Sleeper player data: ${response.status} ${response.statusText}`);\n    }\n    \n    const data = await response.json();\n    return data;\n  } catch (error) {\n    if (error instanceof Error) {\n      throw error;\n    }\n    throw new Error('Failed to fetch player data from Sleeper');\n  }\n}\n\n// Fetch trending players (adds or drops)\nexport async function fetchTrendingPlayers(\n  type: 'add' | 'drop' = 'add',\n  lookbackHours: number = 24\n): Promise<TrendingPlayer[]> {\n  const url = `${SLEEPER_BASE_URL}/players/nfl/trending/${type}?lookback_hours=${lookbackHours}`;\n  \n  try {\n    const response = await fetch(url);\n    \n    if (response.status === 429) {\n      throw new Error('Sleeper API rate limited \u2014 please try again shortly.');\n    }\n    \n    if (!response.ok) {\n      throw new Error(`Failed to fetch trending players: ${response.status} ${response.statusText}`);\n    }\n    \n    const data = await response.json();\n    return data;\n  } catch (error) {\n    if (error instanceof Error) {\n      throw error;\n    }\n    throw new Error('Failed to fetch trending players from Sleeper');\n  }\n}\n\n// Fetch all players without development filtering\nexport async function fetchAllPlayersComplete(): Promise<SleeperPlayer[]> {\n  const players = await fetchAllPlayers();\n  const allPlayers: SleeperPlayer[] = [];\n  \n  for (const [playerId, player] of Object.entries(players)) {\n    // Only include active players\n    if (!player.active) continue;\n    \n    allPlayers.push(player);\n  }\n  \n  return allPlayers;\n}\n\n// Filter and limit players for development\nexport function filterPlayersForDevelopment(players: SleeperPlayersResponse): SleeperPlayer[] {\n  const validPositions = ['QB', 'RB', 'WR', 'TE'];\n  const filteredPlayers: SleeperPlayer[] = [];\n  \n  for (const [playerId, player] of Object.entries(players)) {\n    // Only include active players\n    if (!player.active) continue;\n    \n    // Only include valid positions\n    if (!validPositions.includes(player.position)) continue;\n    \n    // Limit to ~200 players for development\n    if (filteredPlayers.length >= 200) break;\n    \n    filteredPlayers.push(player);\n  }\n  \n  return filteredPlayers;\n}\n\n// Validate required fields for a player\nexport function validatePlayer(player: SleeperPlayer): { isValid: boolean; missingFields: string[] } {\n  const requiredFields = ['full_name', 'position', 'player_id'];\n  const missingFields: string[] = [];\n  \n  for (const field of requiredFields) {\n    if (!player[field]) {\n      missingFields.push(field);\n    }\n  }\n  \n  return {\n    isValid: missingFields.length === 0,\n    missingFields\n  };\n}\n\n// Transform Sleeper player data to our database format\nexport function transformSleeperPlayer(player: SleeperPlayer): any {\n  return {\n    sleeper_id: player.player_id,\n    espn_id: player.espn_id ? player.espn_id.toString() : `SLEEPER_${player.player_id}`, // Use real ESPN ID if available\n    name: player.full_name,\n    position: player.position,\n    team: player.team || 'FA', // Use 'FA' (Free Agent) if no team\n    status: player.status || 'Active',\n    bye_week: null, // Sleeper API doesn't provide bye week data\n\n    // Player details\n    age: player.age,\n    years_exp: player.years_exp,\n    college: player.college,\n    weight: player.weight,\n    height: player.height,\n    jersey_number: player.number,\n\n    // Fantasy data\n    fantasy_positions: player.fantasy_positions ? JSON.stringify(player.fantasy_positions) : null,\n    fantasy_data_id: player.fantasy_data_id,\n    search_rank: player.search_rank,\n\n    // Injury/Status data\n    injury_status: player.injury_status,\n    injury_start_date: player.injury_start_date,\n    injury_notes: player.injury_notes,\n    practice_participation: player.practice_participation,\n    injury_body_part: player.injury_body_part,\n    practice_description: player.practice_description,\n\n    // Team/Depth Chart\n    depth_chart_position: player.depth_chart_position,\n    depth_chart_order: player.depth_chart_order,\n\n    // External IDs\n    yahoo_id: player.yahoo_id,\n    rotowire_id: player.rotowire_id,\n    rotoworld_id: player.rotoworld_id,\n    sportradar_id: player.sportradar_id,\n\n    // Additional Sleeper fields\n    first_name: player.first_name,\n    last_name: player.last_name,\n    birth_date: player.birth_date,\n    birth_city: player.birth_city,\n    birth_state: player.birth_state,\n    birth_country: player.birth_country,\n    high_school: player.high_school,\n    hashtag: player.hashtag,\n    team_abbr: player.team_abbr,\n    team_changed_at: player.team_changed_at,\n    gsis_id: player.gsis_id,\n    swish_id: player.swish_id,\n    stats_id: player.stats_id,\n    oddsjam_id: player.oddsjam_id,\n    opta_id: player.opta_id,\n    pandascore_id: player.pandascore_id,\n    sport: player.sport,\n    news_updated: player.news_updated,\n    search_first_name: player.search_first_name,\n    search_last_name: player.search_last_name,\n    search_full_name: player.search_full_name,\n    metadata: player.metadata ? JSON.stringify(player.metadata) : null,\n    competitions: player.competitions ? JSON.stringify(player.competitions) : null\n  };\n} ", "const FANTASY_PROS_BASE_URL = 'https://api.fantasypros.com/public/v2/json';\n\nexport interface FantasyProsProjection {\n  player_id: string;\n  name: string;\n  position: string;\n  team: string;\n  week: number;\n  season: number;\n  projected_points: number;\n  source: string;\n}\n\nexport interface FantasyProsECR {\n  player_id: string;\n  name: string;\n  position: string;\n  team: string;\n  ecr_rank: number;\n  tier: number;\n  position_rank: number;\n  value_over_replacement: number;\n}\n\nexport interface FantasyProsAuctionValue {\n  player_id: string;\n  name: string;\n  position: string;\n  team: string;\n  auction_value: number;\n  tier: number;\n}\n\nexport interface FantasyProsSOS {\n  player_id: string;\n  name: string;\n  position: string;\n  team: string;\n  sos_rank: number;\n}\n\nexport interface FantasyProsPlayer {\n  player_id: string;\n  name: string;\n  position: string;\n  team: string;\n  filename: string;\n  headshot_url?: string;\n  injury_status?: string;\n  injury_type?: string;\n  injury_update_date?: string;\n  espn_id?: string;\n  yahoo_id?: string;\n  rotowire_id?: string;\n  rotoworld_id?: string;\n  gsis_id?: string;\n}\n\nexport interface FantasyProsNews {\n  id: string;\n  player_id: string;\n  title: string;\n  content: string;\n  date: string;\n  type: string;\n}\n\nexport interface FantasyProsInjury {\n  player_id: string;\n  name: string;\n  position: string;\n  team: string;\n  injury_status: string;\n  injury_type: string;\n  injury_update_date: string;\n  practice_report_injury_type?: string;\n}\n\nexport interface FantasyProsRanking {\n  player_id: string;\n  name: string;\n  position: string;\n  team: string;\n  rank: number;\n  tier: number;\n  position_rank: number;\n  ranking_type: string;\n}\n\nexport interface FantasyProsExpert {\n  id: string;\n  name: string;\n  organization: string;\n  accuracy_score?: number;\n}\n\nexport interface FantasyProsPlayerPoints {\n  player_id: string;\n  name: string;\n  position: string;\n  team: string;\n  week: number;\n  season: number;\n  points: number;\n  points_ppr: number;\n  points_half: number;\n}\n\n// Normalize player names for matching\nexport function normalizePlayerName(name: string): string {\n  if (!name) return '';\n  return name.toLowerCase().replace(/[^a-z0-9]/g, '');\n}\n\n// Rate limiting helper\nlet lastRequestTime = 0;\nconst MIN_REQUEST_INTERVAL = 1000; // 1 second\n\nasync function rateLimitedRequest(url: string, apiKey: string): Promise<any> {\n  const now = Date.now();\n  const timeSinceLastRequest = now - lastRequestTime;\n  \n  if (timeSinceLastRequest < MIN_REQUEST_INTERVAL) {\n    const delay = MIN_REQUEST_INTERVAL - timeSinceLastRequest;\n    await new Promise(resolve => setTimeout(resolve, delay));\n  }\n  \n  lastRequestTime = Date.now();\n  \n  console.log(`Making FantasyPros API request to: ${url}`);\n  console.log(`API Key (first 8 chars): ${apiKey.substring(0, 8)}...`);\n  \n  const response = await fetch(url, {\n    headers: {\n      'X-API-Key': apiKey,\n      'Content-Type': 'application/json',\n      'User-Agent': 'Fantasy-Command-Center/1.0',\n    },\n  });\n  \n  console.log(`FantasyPros API response status: ${response.status} ${response.statusText}`);\n  \n  if (!response.ok) {\n    const errorText = await response.text();\n    console.error(`FantasyPros API error response: ${errorText}`);\n    throw new Error(`FantasyPros API error: ${response.status} ${response.statusText} - ${errorText}`);\n  }\n  \n  return response.json();\n}\n\nexport async function fetchFantasyProsProjections(apiKey: string, week?: number, season?: number): Promise<FantasyProsProjection[]> {\n  // Try to fetch projections for different positions\n  const positions = ['QB', 'RB', 'WR', 'TE', 'K', 'DST'];\n  let allProjections: FantasyProsProjection[] = [];\n  \n  for (const position of positions) {\n    try {\n      let url = `${FANTASY_PROS_BASE_URL}/nfl/${season || 2024}/projections?position=${position}`;\n      if (week) {\n        url += `&week=${week}`;\n      }\n      console.log(`Making projections request to: ${url}`);\n      const data = await rateLimitedRequest(url, apiKey);\n      \n      // Transform the response to match our interface\n      const projections = data.players?.map((item: any) => {\n        const stats = Array.isArray(item.stats) ? item.stats : [];\n        const fpts = stats.find((stat: any) => stat.label === 'FPTS');\n        \n        return {\n          player_id: item.fpid?.toString(),\n          name: item.name,\n          position: item.position_id,\n          team: item.team_id,\n          week: week || 0,\n          season: season || 2024,\n          projected_points: fpts?.value || 0,\n          source: 'FantasyPros',\n        };\n      }) || [];\n      \n      allProjections = allProjections.concat(projections);\n      console.log(`Fetched ${projections.length} ${position} projections`);\n    } catch (error) {\n      console.log(`Failed to fetch ${position} projections: ${error}`);\n      continue;\n    }\n  }\n  \n  return allProjections;\n}\n\nexport async function fetchFantasyProsECR(apiKey: string, week?: number, season?: number): Promise<FantasyProsECR[]> {\n  const params = new URLSearchParams();\n  if (week) params.append('week', week.toString());\n  \n  const url = `${FANTASY_PROS_BASE_URL}/nfl/${season || 2024}/consensus-rankings?${params}`;\n  const data = await rateLimitedRequest(url, apiKey);\n  \n  // Transform the response to match our interface\n  return data.rankings?.map((item: any) => ({\n    player_id: item.fpid?.toString(),\n    name: item.name,\n    position: item.position_id,\n    team: item.team_id,\n    ecr_rank: item.rank,\n    tier: item.tier,\n    position_rank: item.pos_rank,\n    value_over_replacement: item.vor,\n  })) || [];\n}\n\nexport async function fetchFantasyProsAuctionValues(apiKey: string, season?: number): Promise<FantasyProsAuctionValue[]> {\n  // Auction values not available in public API, return empty array\n  console.log('Auction values not available in public FantasyPros API');\n  return [];\n}\n\nexport async function fetchFantasyProsSOS(apiKey: string, season?: number): Promise<FantasyProsSOS[]> {\n  // Schedule strength not available in public API, return empty array\n  console.log('Schedule strength not available in public FantasyPros API');\n  return [];\n}\n\nexport async function fetchFantasyProsPlayers(apiKey: string, sport: string = 'nfl'): Promise<FantasyProsPlayer[]> {\n  const url = `${FANTASY_PROS_BASE_URL}/${sport}/players?external_ids=espn:yahoo:rotowire:rotoworld:nfl`;\n  const data = await rateLimitedRequest(url, apiKey);\n  \n  return data.players?.map((item: any) => ({\n    player_id: item.fpid?.toString(),\n    name: item.name,\n    position: item.position_id,\n    team: item.team_id,\n    filename: item.filename,\n    headshot_url: item.headshot_url,\n    injury_status: item.injury_status,\n    injury_type: item.injury_type,\n    injury_update_date: item.injury_update_date,\n    espn_id: item.espn_id,\n    yahoo_id: item.yahoo_id,\n    rotowire_id: item.rotowire_id,\n    rotoworld_id: item.rotoworld_id,\n    gsis_id: item.nfl_id,\n  })) || [];\n}\n\nexport async function fetchFantasyProsNews(apiKey: string, sport: string = 'nfl', limit: number = 50): Promise<FantasyProsNews[]> {\n  const params = new URLSearchParams();\n  params.append('limit', limit.toString());\n  \n  const url = `${FANTASY_PROS_BASE_URL}/${sport}/news?${params}`;\n  const data = await rateLimitedRequest(url, apiKey);\n  \n  return data.news?.map((item: any) => ({\n    id: item.id?.toString(),\n    player_id: item.player_id?.toString(),\n    title: item.title,\n    content: item.content,\n    date: item.date,\n    type: item.type,\n  })) || [];\n}\n\nexport async function fetchFantasyProsInjuries(apiKey: string, sport: string = 'nfl'): Promise<FantasyProsInjury[]> {\n  const url = `${FANTASY_PROS_BASE_URL}/${sport}/injuries`;\n  const data = await rateLimitedRequest(url, apiKey);\n  \n  return data.injuries?.map((item: any) => ({\n    player_id: item.fpid?.toString(),\n    name: item.name,\n    position: item.position_id,\n    team: item.team_id,\n    injury_status: item.injury_status,\n    injury_type: item.injury_type,\n    injury_update_date: item.injury_update_date,\n    practice_report_injury_type: item.practice_report_injury_type,\n  })) || [];\n}\n\nexport async function fetchFantasyProsRankings(apiKey: string, season: number = 2024, sport: string = 'nfl'): Promise<FantasyProsRanking[]> {\n  const url = `${FANTASY_PROS_BASE_URL}/${sport}/${season}/rankings`;\n  const data = await rateLimitedRequest(url, apiKey);\n  \n  return data.rankings?.map((item: any) => ({\n    player_id: item.fpid?.toString(),\n    name: item.name,\n    position: item.position_id,\n    team: item.team_id,\n    rank: item.rank,\n    tier: item.tier,\n    position_rank: item.pos_rank,\n    ranking_type: item.ranking_type,\n  })) || [];\n}\n\nexport async function fetchFantasyProsConsensusRankings(apiKey: string, season: number = 2024, sport: string = 'nfl'): Promise<FantasyProsRanking[]> {\n  const url = `${FANTASY_PROS_BASE_URL}/${sport}/${season}/consensus-rankings`;\n  const data = await rateLimitedRequest(url, apiKey);\n  \n  return data.rankings?.map((item: any) => ({\n    player_id: item.fpid?.toString(),\n    name: item.name,\n    position: item.position_id,\n    team: item.team_id,\n    rank: item.rank,\n    tier: item.tier,\n    position_rank: item.pos_rank,\n    ranking_type: 'consensus',\n  })) || [];\n}\n\nexport async function fetchFantasyProsExperts(apiKey: string, season: number = 2024, sport: string = 'nfl'): Promise<FantasyProsExpert[]> {\n  const url = `${FANTASY_PROS_BASE_URL}/${sport}/${season}/rankings/experts`;\n  const data = await rateLimitedRequest(url, apiKey);\n  \n  return data.experts?.map((item: any) => ({\n    id: item.id?.toString(),\n    name: item.name,\n    organization: item.organization,\n    accuracy_score: item.accuracy_score,\n  })) || [];\n}\n\nexport async function fetchFantasyProsPlayerPoints(apiKey: string, season: number = 2024, week?: number): Promise<FantasyProsPlayerPoints[]> {\n  const params = new URLSearchParams();\n  if (week) params.append('week', week.toString());\n  \n  const url = `${FANTASY_PROS_BASE_URL}/nfl/${season}/player-points?${params}`;\n  const data = await rateLimitedRequest(url, apiKey);\n  \n  return data.players?.map((item: any) => ({\n    player_id: item.fpid?.toString(),\n    name: item.name,\n    position: item.position_id,\n    team: item.team_id,\n    week: week || 0,\n    season: season,\n    points: item.points,\n    points_ppr: item.points_ppr,\n    points_half: item.points_half,\n  })) || [];\n}\n\n// Match FantasyPros data to players using normalized names\nexport function matchFantasyProsToPlayers(\n  fantasyProsData: any[],\n  players: any[]\n): { matched: any[], unmatched: any[] } {\n  // Create maps for all available ID types\n  const gsisIdMap = new Map();\n  const espnIdMap = new Map();\n  const yahooIdMap = new Map();\n  const rotowireIdMap = new Map();\n  const rotoworldIdMap = new Map();\n  const playerNameMap = new Map();\n  \n  // Create maps of IDs to sleeper_id\n  players.forEach(player => {\n    if (player.gsis_id) {\n      gsisIdMap.set(player.gsis_id.toString(), player.sleeper_id);\n    }\n    if (player.espn_id) {\n      espnIdMap.set(player.espn_id.toString(), player.sleeper_id);\n    }\n    if (player.yahoo_id) {\n      yahooIdMap.set(player.yahoo_id.toString(), player.sleeper_id);\n    }\n    if (player.rotowire_id) {\n      rotowireIdMap.set(player.rotowire_id.toString(), player.sleeper_id);\n    }\n    if (player.rotoworld_id) {\n      rotoworldIdMap.set(player.rotoworld_id.toString(), player.sleeper_id);\n    }\n    if (player.search_full_name) {\n      const normalizedName = normalizePlayerName(player.search_full_name);\n      if (normalizedName) {\n        playerNameMap.set(normalizedName, player.sleeper_id);\n      }\n    }\n  });\n  \n  console.log(`Created ID maps - GSIS: ${gsisIdMap.size}, ESPN: ${espnIdMap.size}, Yahoo: ${yahooIdMap.size}, Rotowire: ${rotowireIdMap.size}, Rotoworld: ${rotoworldIdMap.size}, Names: ${playerNameMap.size}`);\n  console.log(`Processing ${fantasyProsData.length} FantasyPros records`);\n  \n  const matched = [];\n  const unmatched = [];\n  \n  fantasyProsData.forEach((item, index) => {\n    let sleeperId = null;\n    let matchMethod = '';\n    \n    // Try ID matching first (more reliable) - in order of preference\n    if (item.gsis_id && gsisIdMap.has(item.gsis_id.toString())) {\n      sleeperId = gsisIdMap.get(item.gsis_id.toString());\n      matchMethod = 'gsis_id';\n    } else if (item.espn_id && espnIdMap.has(item.espn_id.toString())) {\n      sleeperId = espnIdMap.get(item.espn_id.toString());\n      matchMethod = 'espn_id';\n    } else if (item.yahoo_id && yahooIdMap.has(item.yahoo_id.toString())) {\n      sleeperId = yahooIdMap.get(item.yahoo_id.toString());\n      matchMethod = 'yahoo_id';\n    } else if (item.rotowire_id && rotowireIdMap.has(item.rotowire_id.toString())) {\n      sleeperId = rotowireIdMap.get(item.rotowire_id.toString());\n      matchMethod = 'rotowire_id';\n    } else if (item.rotoworld_id && rotoworldIdMap.has(item.rotoworld_id.toString())) {\n      sleeperId = rotoworldIdMap.get(item.rotoworld_id.toString());\n      matchMethod = 'rotoworld_id';\n    } else if (item.name) {\n      // Fallback to name matching\n      const normalizedName = normalizePlayerName(item.name);\n      if (normalizedName && playerNameMap.has(normalizedName)) {\n        sleeperId = playerNameMap.get(normalizedName);\n        matchMethod = 'name';\n      }\n    }\n    \n    if (sleeperId) {\n      matched.push({\n        ...item,\n        sleeper_id: sleeperId,\n        match_method: matchMethod,\n      });\n    } else {\n      unmatched.push(item);\n      // Log first few unmatched items for debugging\n      if (index < 5) {\n        console.log(`Unmatched: \"${item.name}\" (GSIS: ${item.gsis_id}, ESPN: ${item.espn_id}, Yahoo: ${item.yahoo_id}, Rotowire: ${item.rotowire_id}, Rotoworld: ${item.rotoworld_id})`);\n      }\n    }\n  });\n  \n  console.log(`Matched: ${matched.length}, Unmatched: ${unmatched.length}`);\n  return { matched, unmatched };\n}\n", "import { DatabaseService } from '../utils/db';\nimport {\n  fetchAllPlayers,\n  filterPlayersForDevelopment,\n  validatePlayer,\n  transformSleeperPlayer,\n  fetchTrendingPlayers,\n  fetchAllPlayersComplete\n} from '../services/sleeper';\nimport { upsertTrendingPlayers, getTrendingPlayers, getTrendingPlayersByLookback } from '../utils/db';\nimport {\n  fetchFantasyProsProjections,\n  fetchFantasyProsECR,\n  fetchFantasyProsAuctionValues,\n  fetchFantasyProsSOS,\n  fetchFantasyProsPlayers,\n  fetchFantasyProsNews,\n  fetchFantasyProsInjuries,\n  fetchFantasyProsRankings,\n  fetchFantasyProsConsensusRankings,\n  fetchFantasyProsExperts,\n  fetchFantasyProsPlayerPoints,\n  matchFantasyProsToPlayers\n} from '../services/fantasyPros';\nimport { upsertFantasyProsData, getPlayersWithFantasyData } from '../utils/db';\n\ninterface Env {\n  DB: any;\n  NOAA_BASE_URL: string;\n  ESPN_BASE_URL: string;\n  FANTASYPROS_API_KEY: string;\n}\n\nexport class PlayersHandler {\n  private db: DatabaseService;\n  private env: Env;\n\n  constructor(db: DatabaseService, env: Env) {\n    this.db = db;\n    this.env = env;\n  }\n\n  async handleGet(request: Request): Promise<Response> {\n    try {\n      const url = new URL(request.url);\n      const position = url.searchParams.get('position');\n      const limitParam = url.searchParams.get('limit');\n      const limit = limitParam ? parseInt(limitParam) : -1; // -1 means no limit\n      const search = url.searchParams.get('search');\n\n      // Get players from database\n      let players: any[] = await this.db.getAllPlayers();\n\n      // Add projection_source field to indicate no projections available\n      players = players.map(player => ({\n        ...player,\n        projected_points_week: null,\n        projected_points_season: null,\n        projection_source: 'none'\n      }));\n\n      // Apply filters\n      if (position) {\n        players = players.filter((p: any) => p.position.toUpperCase() === position.toUpperCase());\n      }\n\n      if (search) {\n        const searchLower = search.toLowerCase();\n        players = players.filter((p: any) => \n          p.name.toLowerCase().includes(searchLower) ||\n          p.team.toLowerCase().includes(searchLower)\n        );\n      }\n\n      // Apply limit (only if limit is specified and > 0)\n      if (limit > 0) {\n        players = players.slice(0, limit);\n      }\n\n      return new Response(\n        JSON.stringify(players),\n        { status: 200, headers: { 'Content-Type': 'application/json' } }\n      );\n\n    } catch (error) {\n      console.error('Players GET error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Internal server error' }),\n        { status: 500, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n  }\n\n  async handleSyncSleeper(request: Request): Promise<Response> {\n    try {\n      console.log('Starting Sleeper players sync...');\n\n      // Fetch all players from Sleeper API\n      const players = await fetchAllPlayersComplete();\n      \n      // Transform Sleeper data to our database format\n      const playersToInsert: any[] = [];\n      let skippedCount = 0;\n      \n      for (const player of players) {\n        // Validate required fields\n        const validation = validatePlayer(player);\n        if (!validation.isValid) {\n          console.warn(`Skipping player ${player.player_id}: missing fields: ${validation.missingFields.join(', ')}`);\n          skippedCount++;\n          continue;\n        }\n\n        // Transform Sleeper data to our format using the new function\n        const transformedPlayer = transformSleeperPlayer(player);\n        playersToInsert.push(transformedPlayer);\n      }\n\n      // Store players in database\n      if (playersToInsert.length > 0) {\n        await this.db.upsertSleeperPlayers(playersToInsert);\n      }\n\n      return new Response(\n        JSON.stringify({ \n          success: true, \n          message: `Synced ${playersToInsert.length} players from Sleeper (${skippedCount} skipped due to missing data)`,\n          count: playersToInsert.length,\n          skipped: skippedCount\n        }),\n        { status: 200, headers: { 'Content-Type': 'application/json' } }\n      );\n\n    } catch (error) {\n      console.error('Sync Sleeper error:', error);\n      \n      let errorMessage = 'Failed to sync players from Sleeper';\n      if (error instanceof Error) {\n        errorMessage = error.message;\n      }\n      \n      return new Response(\n        JSON.stringify({ error: errorMessage }),\n        { status: 500, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n  }\n\n  async handleTrendingPlayers(request: Request): Promise<Response> {\n    try {\n      const url = new URL(request.url);\n      const type = url.searchParams.get('type') as 'add' | 'drop' || 'add';\n      const lookbackHours = parseInt(url.searchParams.get('lookback_hours') || '24');\n\n      console.log(`Fetching trending players (${type}) from Sleeper...`);\n\n      // Fetch trending players from Sleeper API\n      const trendingPlayers = await fetchTrendingPlayers(type, lookbackHours);\n\n      // Get player details for trending players\n      const playerDetails = await this.db.getPlayersBySleeperIds(\n        trendingPlayers.map(p => p.player_id)\n      );\n\n      // Combine trending data with player details\n      const enrichedTrendingPlayers = trendingPlayers.map(trending => {\n        const playerDetail = playerDetails.find(p => p.sleeper_id === trending.player_id);\n        return {\n          ...trending,\n          player: playerDetail || null\n        };\n      });\n\n      return new Response(\n        JSON.stringify({\n          success: true,\n          type,\n          lookback_hours: lookbackHours,\n          players: enrichedTrendingPlayers\n        }),\n        { status: 200, headers: { 'Content-Type': 'application/json' } }\n      );\n\n    } catch (error) {\n      console.error('Trending players error:', error);\n      \n      let errorMessage = 'Failed to fetch trending players from Sleeper';\n      if (error instanceof Error) {\n        errorMessage = error.message;\n      }\n      \n      return new Response(\n        JSON.stringify({ error: errorMessage }),\n        { status: 500, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n  }\n\n  async handleSyncESPN(request: Request): Promise<Response> {\n    try {\n      const body = await request.json() as any;\n      const leagueId = body.leagueId;\n\n      if (!leagueId) {\n        return new Response(\n          JSON.stringify({ error: 'leagueId is required' }),\n          { status: 400, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      console.log(`Starting ESPN sync for league ${leagueId}...`);\n\n      // This endpoint is deprecated - redirect to Sleeper sync\n      return new Response(\n        JSON.stringify({ \n          error: 'ESPN sync is deprecated. Please use /sync/players to sync from Sleeper API.',\n          message: 'Use POST /sync/players to sync player data from Sleeper'\n        }),\n        { status: 400, headers: { 'Content-Type': 'application/json' } }\n      );\n\n    } catch (error) {\n      console.error('Sync ESPN error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Failed to sync ESPN players' }),\n        { status: 500, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n  }\n\n  async handleSyncPlayers(request: Request): Promise<Response> {\n    try {\n      const url = new URL(request.url);\n      const pathParts = url.pathname.split('/');\n      const leagueId = pathParts[pathParts.length - 1]; // Get leagueId from URL path\n\n      if (!leagueId) {\n        return new Response(\n          JSON.stringify({ error: 'leagueId is required in URL path' }),\n          { status: 400, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      console.log(`Starting ESPN players sync for league ${leagueId}...`);\n\n      // This endpoint is deprecated - redirect to Sleeper sync\n      return new Response(\n        JSON.stringify({ \n          error: 'ESPN sync is deprecated. Please use /sync/players to sync from Sleeper API.',\n          message: 'Use POST /sync/players to sync player data from Sleeper'\n        }),\n        { status: 400, headers: { 'Content-Type': 'application/json' } }\n      );\n\n    } catch (error) {\n      console.error('Sync players error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Failed to sync players from ESPN' }),\n        { status: 500, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n  }\n\n  async handleSyncTrendingPlayers(request: Request): Promise<Response> {\n    try {\n      const url = new URL(request.url);\n      const type = url.searchParams.get('type') || 'add';\n      const lookbackHours = parseInt(url.searchParams.get('lookback_hours') || '24');\n\n      console.log(`Starting trending players sync for type: ${type}, lookback: ${lookbackHours}h`);\n\n      // Fetch trending players from Sleeper\n      const trendingPlayers = await fetchTrendingPlayers(type, lookbackHours);\n      \n      if (!trendingPlayers || trendingPlayers.length === 0) {\n        return new Response(JSON.stringify({\n          success: false,\n          message: 'No trending players found'\n        }), {\n          status: 404,\n          headers: { 'Content-Type': 'application/json' }\n        });\n      }\n\n      // Store trending players in database\n      await upsertTrendingPlayers(this.db.db, trendingPlayers, type, lookbackHours);\n\n      console.log(`Successfully synced ${trendingPlayers.length} trending players`);\n\n      return new Response(JSON.stringify({\n        success: true,\n        message: `Synced ${trendingPlayers.length} trending players`,\n        data: {\n          type,\n          lookback_hours: lookbackHours,\n          count: trendingPlayers.length,\n          players: trendingPlayers\n        }\n      }), {\n        status: 200,\n        headers: { 'Content-Type': 'application/json' }\n      });\n\n    } catch (error) {\n      console.error('Error syncing trending players:', error);\n      \n      let errorMessage = 'Failed to sync trending players';\n      if (error instanceof Error) {\n        if (error.message.includes('429')) {\n          errorMessage = 'Sleeper API rate limited \u2014 please try again shortly.';\n        } else {\n          errorMessage = error.message;\n        }\n      }\n\n      return new Response(JSON.stringify({\n        success: false,\n        message: errorMessage\n      }), {\n        status: 500,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n  }\n\n  async handleSyncFantasyPros(request: Request): Promise<Response> {\n    try {\n      const url = new URL(request.url);\n      const week = url.searchParams.get('week') ? parseInt(url.searchParams.get('week')!) : undefined;\n      const season = url.searchParams.get('season') ? parseInt(url.searchParams.get('season')!) : 2024;\n      \n      console.log(`Starting FantasyPros sync for week: ${week}, season: ${season}`);\n      \n      // Get all players for matching\n      const allPlayers = await this.db.getAllPlayers();\n      \n      // Fetch all FantasyPros data - start with just players to test\n      const [projections, ecr, auctionValues, sos, players, news, injuries, rankings, consensusRankings, experts, playerPoints] = await Promise.all([\n        fetchFantasyProsProjections(this.env.FANTASYPROS_API_KEY!, week, season),\n        Promise.resolve([]), // fetchFantasyProsECR(this.env.FANTASYPROS_API_KEY!, week, season),\n        Promise.resolve([]), // fetchFantasyProsAuctionValues(this.env.FANTASYPROS_API_KEY!, season),\n        Promise.resolve([]), // fetchFantasyProsSOS(this.env.FANTASYPROS_API_KEY!, season),\n        fetchFantasyProsPlayers(this.env.FANTASYPROS_API_KEY!, 'nfl'),\n        Promise.resolve([]), // fetchFantasyProsNews(this.env.FANTASYPROS_API_KEY!, 'nfl', 50),\n        Promise.resolve([]), // fetchFantasyProsInjuries(this.env.FANTASYPROS_API_KEY!, 'nfl'),\n        Promise.resolve([]), // fetchFantasyProsRankings(this.env.FANTASYPROS_API_KEY!, season, 'nfl'),\n        Promise.resolve([]), // fetchFantasyProsConsensusRankings(this.env.FANTASYPROS_API_KEY!, season, 'nfl'),\n        Promise.resolve([]), // fetchFantasyProsExperts(this.env.FANTASYPROS_API_KEY!, season, 'nfl'),\n        Promise.resolve([])  // fetchFantasyProsPlayerPoints(this.env.FANTASYPROS_API_KEY!, season, week)\n      ]);\n      \n      // Match and combine all data\n      const allFantasyProsData = [\n        ...projections.map(p => ({ ...p, data_type: 'projection' })),\n        ...ecr.map(e => ({ ...e, data_type: 'ecr' })),\n        ...auctionValues.map(a => ({ ...a, data_type: 'auction' })),\n        ...sos.map(s => ({ ...s, data_type: 'sos' })),\n        ...players.map(p => ({ ...p, data_type: 'player' })),\n        ...news.map(n => ({ ...n, data_type: 'news' })),\n        ...injuries.map(i => ({ ...i, data_type: 'injury' })),\n        ...rankings.map(r => ({ ...r, data_type: 'ranking' })),\n        ...consensusRankings.map(cr => ({ ...cr, data_type: 'consensus_ranking' })),\n        ...playerPoints.map(pp => ({ ...pp, data_type: 'player_points' }))\n      ];\n      \n      const { matched, unmatched } = matchFantasyProsToPlayers(allFantasyProsData, allPlayers);\n      \n      if (matched.length > 0) {\n        await upsertFantasyProsData(this.db.db, matched);\n        console.log(`Successfully synced ${matched.length} FantasyPros records (${unmatched.length} unmatched)`);\n        \n        return new Response(JSON.stringify({\n          success: true,\n          message: `Synced ${matched.length} FantasyPros records`,\n          data: {\n            week,\n            season,\n            matched_count: matched.length,\n            unmatched_count: unmatched.length,\n            unmatched_sample: unmatched.slice(0, 10) // Return sample of unmatched for debugging\n          }\n        }), {\n          headers: { 'Content-Type': 'application/json' }\n        });\n      } else {\n        return new Response(JSON.stringify({\n          success: true,\n          message: 'No FantasyPros data matched to players',\n          data: { week, season, matched_count: 0, unmatched_count: allFantasyProsData.length }\n        }), {\n          headers: { 'Content-Type': 'application/json' }\n        });\n      }\n    } catch (error) {\n      console.error('Sync FantasyPros error:', error);\n      return new Response(JSON.stringify({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error'\n      }), {\n        status: 500,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n  }\n\n  async handleGetPlayersWithFantasyData(request: Request): Promise<Response> {\n    try {\n      const url = new URL(request.url);\n      const week = url.searchParams.get('week') ? parseInt(url.searchParams.get('week')!) : undefined;\n      const season = url.searchParams.get('season') ? parseInt(url.searchParams.get('season')!) : 2024;\n      \n      const players = await getPlayersWithFantasyData(this.db.db, week, season);\n      \n      return new Response(JSON.stringify({\n        success: true,\n        data: {\n          week,\n          season,\n          count: players.length,\n          players\n        }\n      }), {\n        headers: { 'Content-Type': 'application/json' }\n      });\n    } catch (error) {\n      console.error('Get players with fantasy data error:', error);\n      return new Response(JSON.stringify({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error'\n      }), {\n        status: 500,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n  }\n\n  async handleTestFantasyProsKey(request: Request): Promise<Response> {\n    try {\n      const apiKey = this.env.FANTASYPROS_API_KEY;\n      const keyPreview = apiKey ? `${apiKey.substring(0, 8)}...` : 'NOT_FOUND';\n      \n      return new Response(JSON.stringify({\n        success: true,\n        message: 'FantasyPros API key status',\n        data: {\n          key_available: !!apiKey,\n          key_preview: keyPreview,\n          key_length: apiKey ? apiKey.length : 0\n        }\n      }), {\n        headers: { 'Content-Type': 'application/json' }\n      });\n    } catch (error) {\n      console.error('Test FantasyPros key error:', error);\n      return new Response(JSON.stringify({\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error'\n      }), {\n        status: 500,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n  }\n} \n\nexport async function handleGetTrendingPlayers(request: Request, db: any): Promise<Response> {\n  try {\n    const url = new URL(request.url);\n    const type = url.searchParams.get('type') || 'add';\n    const lookbackHours = url.searchParams.get('lookback_hours');\n    const limit = parseInt(url.searchParams.get('limit') || '10');\n\n    let trendingPlayers;\n    if (lookbackHours) {\n      trendingPlayers = await getTrendingPlayersByLookback(db, type, parseInt(lookbackHours), limit);\n    } else {\n      trendingPlayers = await getTrendingPlayers(db, type, limit);\n    }\n\n    return new Response(JSON.stringify({\n      success: true,\n      data: {\n        type,\n        lookback_hours: lookbackHours,\n        count: trendingPlayers.length,\n        players: trendingPlayers\n      }\n    }), {\n      status: 200,\n      headers: { 'Content-Type': 'application/json' }\n    });\n\n  } catch (error) {\n    console.error('Error fetching trending players:', error);\n    \n    return new Response(JSON.stringify({\n      success: false,\n      message: 'Failed to fetch trending players'\n    }), {\n      status: 500,\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n} ", "import { DatabaseService } from '../utils/db';\n\nexport class AlertsHandler {\n  private db: DatabaseService;\n\n  constructor(db: DatabaseService) {\n    this.db = db;\n  }\n\n  async handleGet(request: Request): Promise<Response> {\n    try {\n      const url = new URL(request.url);\n      const userId = url.searchParams.get('userId');\n      const leagueId = url.searchParams.get('leagueId');\n      const status = url.searchParams.get('status');\n      const limit = url.searchParams.get('limit');\n\n      if (!userId) {\n        return new Response(\n          JSON.stringify({ error: 'userId query parameter is required' }),\n          { status: 400, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      const alertsResult = await this.db.getAlerts(userId, leagueId || undefined);\n      let alerts = alertsResult.results || [];\n\n      // Apply status filter if provided\n      if (status) {\n        alerts = alerts.filter((a: any) => a.status === status);\n      }\n\n      // Apply limit\n      const limitNum = limit ? parseInt(limit, 10) : 50;\n      if (limitNum > 0) {\n        alerts = alerts.slice(0, limitNum);\n      }\n\n      return new Response(\n        JSON.stringify({\n          alerts: alerts,\n          count: alerts.length\n        }),\n        { status: 200, headers: { 'Content-Type': 'application/json' } }\n      );\n\n    } catch (error) {\n      console.error('Alerts GET error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Internal server error' }),\n        { status: 500, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n  }\n\n  async handlePost(request: Request): Promise<Response> {\n    try {\n      const body = await request.json() as any;\n      const { userId, leagueId, type, message } = body;\n\n      if (!userId || !leagueId || !type || !message) {\n        return new Response(\n          JSON.stringify({ error: 'userId, leagueId, type, and message are required' }),\n          { status: 400, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      // Validate alert type\n      const validTypes = ['injury', 'trade', 'waiver', 'news', 'weather', 'system'];\n      if (!validTypes.includes(type)) {\n        return new Response(\n          JSON.stringify({ error: 'Invalid alert type. Must be one of: ' + validTypes.join(', ') }),\n          { status: 400, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      const result = await this.db.createAlert(userId, leagueId, type, message);\n\n      return new Response(\n        JSON.stringify({\n          success: true,\n          message: 'Alert created successfully',\n          id: result.meta?.last_row_id\n        }),\n        { status: 201, headers: { 'Content-Type': 'application/json' } }\n      );\n\n    } catch (error) {\n      console.error('Alerts POST error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Internal server error' }),\n        { status: 500, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n  }\n\n  async handlePatch(request: Request): Promise<Response> {\n    try {\n      const body = await request.json() as any;\n      const { alertId } = body;\n\n      if (!alertId) {\n        return new Response(\n          JSON.stringify({ error: 'alertId is required' }),\n          { status: 400, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      const alertIdNum = parseInt(alertId, 10);\n      if (isNaN(alertIdNum)) {\n        return new Response(\n          JSON.stringify({ error: 'alertId must be a valid number' }),\n          { status: 400, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      const result = await this.db.markAlertAsRead(alertIdNum);\n\n      if (result.meta?.changes === 0) {\n        return new Response(\n          JSON.stringify({ error: 'Alert not found or already marked as read' }),\n          { status: 404, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      return new Response(\n        JSON.stringify({\n          success: true,\n          message: 'Alert marked as read successfully'\n        }),\n        { status: 200, headers: { 'Content-Type': 'application/json' } }\n      );\n\n    } catch (error) {\n      console.error('Alerts PATCH error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Internal server error' }),\n        { status: 500, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n  }\n} ", "import { DatabaseService } from '../utils/db';\nimport { fetchTeamRoster } from '../services/espn';\n\nexport interface TeamPlayer {\n  espn_id: string;\n  name: string;\n  position: string;\n  team: string;\n  status: string;\n  bye_week: number | null;\n  projected_points_week: number | null;\n  projected_points_season: number | null;\n  projection_source: string;\n}\n\nexport class TeamHandler {\n  private db: DatabaseService;\n\n  constructor(db: DatabaseService) {\n    this.db = db;\n  }\n\n  async handleGet(request: Request): Promise<Response> {\n    try {\n      const url = new URL(request.url);\n      const pathParts = url.pathname.split('/');\n      \n      // Extract leagueId and teamId from path: /team/:leagueId/:teamId\n      const leagueIdIndex = pathParts.indexOf('team') + 1;\n      const leagueId = pathParts[leagueIdIndex];\n      const teamId = pathParts[leagueIdIndex + 1];\n\n      if (!leagueId || !teamId) {\n        return new Response(\n          JSON.stringify({ error: 'leagueId and teamId are required in URL path' }),\n          { status: 400, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      console.log(`Fetching team roster for league ${leagueId}, team ${teamId}...`);\n\n      // Fetch team roster from ESPN\n      const rosterData = await fetchTeamRoster(leagueId, parseInt(teamId));\n      \n      if (!rosterData || !rosterData.teams || !rosterData.teams[0]) {\n        return new Response(\n          JSON.stringify({ error: 'No team data found' }),\n          { status: 404, headers: { 'Content-Type': 'application/json' } }\n        );\n      }\n\n      const team = rosterData.teams[0];\n      const teamPlayers: TeamPlayer[] = [];\n\n      // Process each player in the roster\n      if (team.roster && team.roster.entries) {\n        for (const entry of team.roster.entries) {\n          if (!entry.playerPoolEntry || !entry.playerPoolEntry.player) {\n            continue;\n          }\n\n          const player = entry.playerPoolEntry.player;\n          const espnId = player.id.toString();\n\n          // Get player from database to get additional info\n          const dbPlayer = await this.db.getPlayerByEspnId(espnId);\n          \n          // Get projection if available\n          const projection = dbPlayer ? await this.db.getProjectionByPlayerId(dbPlayer.id) : null;\n\n          teamPlayers.push({\n            espn_id: espnId,\n            name: player.fullName || `${player.firstName} ${player.lastName}`,\n            position: dbPlayer?.position || 'UNK',\n            team: dbPlayer?.team || 'FA',\n            status: player.injuryStatus || 'healthy',\n            bye_week: dbPlayer?.bye_week || null,\n            projected_points_week: projection?.projected_points || null,\n            projected_points_season: null, // ESPN doesn't provide season projections\n            projection_source: projection?.source || 'none'\n          });\n        }\n      }\n\n      return new Response(\n        JSON.stringify({\n          success: true,\n          team: {\n            id: team.id,\n            name: team.name,\n            abbreviation: team.abbreviation\n          },\n          players: teamPlayers,\n          count: teamPlayers.length\n        }),\n        { status: 200, headers: { 'Content-Type': 'application/json' } }\n      );\n\n    } catch (error) {\n      console.error('Team GET error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Failed to fetch team roster' }),\n        { status: 500, headers: { 'Content-Type': 'application/json' } }\n      );\n    }\n  }\n} ", "import { DatabaseService } from './utils/db';\nimport { NOAAService } from './services/noaa';\nimport { LeagueHandler } from './handlers/league';\nimport { PlayersHandler } from './handlers/players';\nimport { AlertsHandler } from './handlers/alerts';\nimport { TeamHandler } from './handlers/team';\nimport { \n  fetchAllPlayers, \n  filterPlayersForDevelopment, \n  validatePlayer, \n  transformSleeperPlayer, \n  fetchTrendingPlayers,\n  fetchAllPlayersComplete\n} from './services/sleeper';\nimport { \n  upsertTrendingPlayers \n} from './utils/db';\n\n// Cloudflare Workers types\ninterface ExecutionContext {\n  waitUntil(promise: Promise<any>): void;\n  passThroughOnException(): void;\n}\n\ninterface ScheduledEvent {\n  cron: string;\n  scheduledTime: number;\n  type: string;\n}\n\nexport interface Env {\n  DB: any; // D1Database type\n  NOAA_BASE_URL: string;\n  ESPN_BASE_URL: string;\n}\n\nexport default {\n  async fetch(request: Request, env: Env, ctx: ExecutionContext): Promise<Response> {\n    const url = new URL(request.url);\n    const path = url.pathname;\n\n    // Initialize services\n    const db = new DatabaseService(env.DB);\n    const noaaService = new NOAAService(env.NOAA_BASE_URL);\n\n    // Initialize handlers\n    const leagueHandler = new LeagueHandler(db);\n    const playersHandler = new PlayersHandler(db, env);\n    const alertsHandler = new AlertsHandler(db);\n    const teamHandler = new TeamHandler(db);\n\n    // CORS headers\n    const corsHeaders = {\n      'Access-Control-Allow-Origin': '*',\n      'Access-Control-Allow-Methods': 'GET, POST, PUT, DELETE, PATCH, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n    };\n\n    // Handle preflight requests\n    if (request.method === 'OPTIONS') {\n      return new Response(null, { status: 200, headers: corsHeaders });\n    }\n\n    try {\n      let response: Response;\n\n      switch (path) {\n        case '/league':\n          if (request.method === 'POST') {\n            response = await leagueHandler.handlePost(request);\n          } else if (request.method === 'GET') {\n            response = await leagueHandler.handleGet(request);\n          } else {\n            response = new Response('Method not allowed', { status: 405 });\n          }\n          break;\n\n        case '/players':\n          if (request.method === 'GET') {\n            response = await playersHandler.handleGet(request);\n          } else {\n            response = new Response('Method not allowed', { status: 405 });\n          }\n          break;\n\n        case '/sync/players':\n          if (request.method === 'POST') {\n            response = await playersHandler.handleSyncSleeper(request);\n          } else {\n            response = new Response('Method not allowed', { status: 405 });\n          }\n          break;\n\n        case '/trending/players':\n          if (request.method === 'GET') {\n            response = await playersHandler.handleTrendingPlayers(request);\n          } else {\n            response = new Response('Method not allowed', { status: 405 });\n          }\n          break;\n\n        case '/sync/trending':\n          if (request.method === 'POST') {\n            response = await playersHandler.handleSyncTrendingPlayers(request);\n          } else {\n            response = new Response('Method not allowed', { status: 405 });\n          }\n          break;\n\n        case '/sync/fantasy-pros':\n          if (request.method === 'POST') {\n            response = await playersHandler.handleSyncFantasyPros(request);\n          } else {\n            response = new Response('Method not allowed', { status: 405 });\n          }\n          break;\n\n        case '/players/with-fantasy-data':\n          if (request.method === 'GET') {\n            response = await playersHandler.handleGetPlayersWithFantasyData(request);\n          } else {\n            response = new Response('Method not allowed', { status: 405 });\n          }\n          break;\n\n        case '/test/fantasy-pros-key':\n          if (request.method === 'GET') {\n            response = await playersHandler.handleTestFantasyProsKey(request);\n          } else {\n            response = new Response('Method not allowed', { status: 405 });\n          }\n          break;\n\n        case '/sync/espn':\n          if (request.method === 'POST') {\n            response = await playersHandler.handleSyncESPN(request);\n          } else {\n            response = new Response('Method not allowed', { status: 405 });\n          }\n          break;\n\n        case '/alerts':\n          if (request.method === 'GET') {\n            response = await alertsHandler.handleGet(request);\n          } else if (request.method === 'POST') {\n            response = await alertsHandler.handlePost(request);\n          } else if (request.method === 'PATCH') {\n            response = await alertsHandler.handlePatch(request);\n          } else {\n            response = new Response('Method not allowed', { status: 405 });\n          }\n          break;\n\n        case '/health':\n          response = new Response(\n            JSON.stringify({ status: 'healthy', timestamp: new Date().toISOString() }),\n            { status: 200, headers: { 'Content-Type': 'application/json' } }\n          );\n          break;\n\n        default:\n          // Handle path-based endpoints\n          if (path.startsWith('/team/') && request.method === 'GET') {\n            response = await teamHandler.handleGet(request);\n          } else if (path.startsWith('/sync/players/') && request.method === 'POST') {\n            response = await playersHandler.handleSyncPlayers(request);\n          } else if (path.startsWith('/league/') && path.endsWith('/settings') && request.method === 'GET') {\n            response = await leagueHandler.handleGetLeagueSettings(request);\n          } else {\n            response = new Response('Not found', { status: 404 });\n          }\n          break;\n      }\n\n      // Add CORS headers to all responses\n      const responseHeaders = new Headers(response.headers);\n      Object.entries(corsHeaders).forEach(([key, value]) => {\n        responseHeaders.set(key, value);\n      });\n\n      return new Response(response.body, {\n        status: response.status,\n        statusText: response.statusText,\n        headers: responseHeaders,\n      });\n\n    } catch (error) {\n      console.error('Request error:', error);\n      return new Response(\n        JSON.stringify({ error: 'Internal server error' }),\n        { \n          status: 500, \n          headers: { \n            'Content-Type': 'application/json',\n            ...corsHeaders\n          } \n        }\n      );\n    }\n  },\n\n  async scheduled(event: ScheduledEvent, env: Env, ctx: ExecutionContext): Promise<void> {\n    console.log(`Running scheduled job with cron: ${event.cron}`);\n    \n    // Check which cron job this is\n    if (event.cron === \"0 6 * * *\") {\n      // Daily Sleeper API sync job\n      console.log('Running daily Sleeper API sync job...');\n      \n      try {\n        // Initialize services\n        const db = new DatabaseService(env.DB);\n\n        // 1. Sync all players from Sleeper API\n        console.log('Syncing all players from Sleeper API...');\n        const players = await fetchAllPlayersComplete();\n        \n        const validPlayers = [];\n        let skippedCount = 0;\n        \n        for (const player of players) {\n          const validation = validatePlayer(player);\n          if (validation.isValid) {\n            const transformedPlayer = transformSleeperPlayer(player);\n            validPlayers.push(transformedPlayer);\n          } else {\n            skippedCount++;\n          }\n        }\n        \n        if (validPlayers.length > 0) {\n          await db.upsertSleeperPlayers(validPlayers);\n        }\n        console.log(`Successfully synced ${validPlayers.length} players from Sleeper API (${skippedCount} skipped)`);\n\n        // 2. Sync trending players (both add and drop)\n        console.log('Syncing trending players from Sleeper API...');\n        const trendingTypes = ['add', 'drop'];\n        const lookbackHours = 24;\n        \n        for (const type of trendingTypes) {\n          try {\n            console.log(`Fetching trending ${type} players with ${lookbackHours}h lookback...`);\n            const trendingPlayers = await fetchTrendingPlayers(type, lookbackHours);\n            \n            if (trendingPlayers && trendingPlayers.length > 0) {\n              await upsertTrendingPlayers(env.DB, trendingPlayers, type, lookbackHours);\n              console.log(`Successfully synced ${trendingPlayers.length} trending ${type} players`);\n            } else {\n              console.log(`No trending ${type} players found for ${lookbackHours}h lookback`);\n            }\n          } catch (error) {\n            console.error(`Error syncing trending ${type} players:`, error);\n            // Continue with other types even if one fails\n          }\n        }\n\n        console.log('Daily Sleeper API sync job completed successfully');\n      } catch (error) {\n        console.error('Scheduled job error:', error);\n      }\n    } else if (event.cron === \"0 * * * *\") {\n      // Hourly FantasyPros API sync job\n      console.log('Running hourly FantasyPros API sync job...');\n      \n      try {\n        // Initialize services\n        const db = new DatabaseService(env.DB);\n        const playersHandler = new PlayersHandler(db, env);\n        \n        // Create a mock request for the FantasyPros sync\n        const mockRequest = new Request('https://fantasy-command-center-api.kevin-mcgovern.workers.dev/sync/fantasy-pros', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' }\n        });\n        \n        const response = await playersHandler.handleSyncFantasyPros(mockRequest);\n        const result = await response.json();\n        \n        if (result.success) {\n          console.log('Hourly FantasyPros API sync job completed successfully:', result.message);\n        } else {\n          console.error('FantasyPros sync failed:', result.error);\n        }\n      } catch (error) {\n        console.error('FantasyPros scheduled job error:', error);\n      }\n    } else {\n      console.log(`Unknown cron pattern: ${event.cron}`);\n    }\n  },\n\n  getCurrentWeek(date: Date): number {\n    // Simple week calculation - you might want to make this more sophisticated\n    const seasonStart = new Date(2024, 8, 5); // September 5, 2024\n    const diffTime = date.getTime() - seasonStart.getTime();\n    const diffWeeks = Math.ceil(diffTime / (1000 * 60 * 60 * 24 * 7));\n    return Math.max(1, Math.min(18, diffWeeks));\n  }\n}; ", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"/Users/kevinmcgovern/fantasy-command-center/fantasy-command-center/apps/api/src/index.ts\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"/Users/kevinmcgovern/fantasy-command-center/fantasy-command-center/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"/Users/kevinmcgovern/fantasy-command-center/fantasy-command-center/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"/Users/kevinmcgovern/fantasy-command-center/fantasy-command-center/apps/api/src/index.ts\";\n\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"/Users/kevinmcgovern/fantasy-command-center/fantasy-command-center/apps/api/.wrangler/tmp/bundle-41kHW4/middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"/Users/kevinmcgovern/fantasy-command-center/fantasy-command-center/node_modules/wrangler/templates/middleware/common.ts\";\nimport type { WorkerEntrypointConstructor } from \"/Users/kevinmcgovern/fantasy-command-center/fantasy-command-center/apps/api/.wrangler/tmp/bundle-41kHW4/middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"/Users/kevinmcgovern/fantasy-command-center/fantasy-command-center/apps/api/.wrangler/tmp/bundle-41kHW4/middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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",
  "names": []
}
